<!DOCTYPE html>
<!--
SAVE ONTO AWS: aws s3 cp . s3://charlesding.info/Projects/asaptutor --recursive
-->
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AsapTutor | 1:1 Tutoring</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="plugins/select2/select2.min.css">
     <!-- bootstrap slider -->
    <link rel="stylesheet" href="plugins/bootstrap-slider/slider.css">
    <!-- daterange picker -->
    <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker-bs3.css">
    <!-- Bootstrap time Picker -->
    <link rel="stylesheet" href="plugins/timepicker/bootstrap-timepicker.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
             <!--   <link rel="stylesheet" href="dist/css/skins/skin-blue.min.css"> -->
    <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


  <style>
    #mainbox {
      //position:absolute; 
      //bottom:0px; 
      //width:calc(100% - 30px);
      background: rgb(255, 255, 255); /* Fall-back for browsers that don't support rgba */
      background: rgba(255, 255, 255, 0.8);
    }
    #classSelection {
      top:8px;
      left:50px;
      right:60px;
    }
    @media screen and (min-width: 768px) {
        #mainbox {
          //margin-top:100px;
          //position:absolute; 
          //bottom:0px; 
          //width:calc(100% - 260px);
          background: rgb(255, 255, 255); /* Fall-back for browsers that don't support rgba */
          background: rgba(255, 255, 255, 0.8);
        }
        #classSelection {
          top:8px;
          right:170px;
          left:50px;
        }
    }
    .mainbox-footer {
      background: rgb(255, 255, 255); /* Fall-back for browsers that don't support rgba */
      background: rgba(255, 255, 255, 0);
    }
  </style>
  </head>
  <!--
  BODY TAG OPTIONS:
  =================
  Apply one or more of the following classes to get the
  desired effect
  |---------------------------------------------------------|
  | SKINS         | skin-blue                               |
  |               | skin-black                              |
  |               | skin-purple                             |
  |               | skin-yellow                             |
  |               | skin-red                                |
  |               | skin-green                              |
  |---------------------------------------------------------|
  |LAYOUT OPTIONS | fixed                                   |
  |               | layout-boxed                            |
  |               | layout-top-nav                          |
  |               | sidebar-collapse                        |
  |               | sidebar-mini                            |
  |---------------------------------------------------------|
  -->
  <body class="hold-transition skin-blue sidebar-mini">
    <div id="globalwrapper" class="wrapper">

      <!-- Main Header -->
      <header class="main-header">

        <!-- Logo -->
        <a href="index2.html" class="logo">
          <!-- mini logo for sidebar mini 50x50 pixels -->
          <span class="logo-mini"><b>A</b>T</span>
          <!-- logo for regular state and mobile devices -->
          <span class="logo-lg"><small>ASAP</small><b>Tutor</b></span>
        </a>

        <!-- Header Navbar -->
        <nav class="navbar navbar-static-top" role="navigation">
          <!-- Sidebar toggle button-->
          <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">Toggle navigation</span>
          </a>

          <!-- Class Selection -->
          <div id="classSelection" class="form-group" style="position:absolute;">
            <select id="select2ClassSelection" class="form-control select2" multiple="multiple" data-placeholder="Select a Course">
              <option>CS 1001</option>
              <option>Psyc 1001</option>
              <option>Calc 2654</option>
              <option>CS 2003</option>
              <option>EE 3300</option>
              <option>CS 2001</option>
              <option>CS 2345</option>
            </select>
          </div><!-- /.form-group -->
          <!-- Navbar Right Menu -->
          <div class="navbar-custom-menu">
            <ul class="nav navbar-nav">
              <!-- User Account Menu -->
              <li class="dropdown user user-menu">
                <!-- Menu Toggle Button -->
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <!-- The user image in the navbar-->
                  <img id="userImageNavbar" src="dist/img/user2-160x160.jpg" class="user-image" alt="User Image">
                  <!-- hidden-xs hides the username on small devices so only the image appears. -->
                  <span class="hidden-xs studentName">(Student's Name)</span>
                </a>
                <ul class="dropdown-menu" style="right:0px;">
                  <!-- The user image in the menu -->
                  <li class="user-header">
                    <img id="userImageHeader" src="dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                    <p>
                      <span class="studentName">(Student's Name)</span>
                      <small>Member since Nov. 2012</small>
                    </p>
                  </li>
                  <!-- Menu Body -->
                  <li class="user-body">
                    <div class="col-xs-6 text-center">
                      <a href="#">Followers</a>
                    </div>
                    <div class="col-xs-6 text-center">
                      <a href="#">Friends</a>
                    </div>
                  </li>
                  <!-- Menu Footer-->
                  <li class="user-footer">
                    <div class="pull-left">
                      <a href="#" class="btn btn-default btn-flat">Profile</a>
                    </div>
                    <div class="pull-right">
                      <a href="#" class="btn btn-default btn-flat" onclick="signOut();">Sign out</a>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside id="mainleftsidebar" class="main-sidebar">
        <div id="mainleftsidebardiv">
          <!-- sidebar: style can be found in sidebar.less -->
          <section class="sidebar">

            <!-- Sidebar user panel (optional) -->
            <div class="user-panel">
              <div class="pull-left image">
                <img id="userImagePanel" src="dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
              </div>
              <div class="pull-left info">
                <p class="studentName">(Student's Name)</p>
                <!-- Status -->
                <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
              </div>
            </div>

            <!-- search form (Optional) -->
            <form action="#" method="get" class="sidebar-form">
              <div class="input-group">
                <input type="text" name="q" class="form-control" placeholder="Search...">
                <span class="input-group-btn">
                  <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i></button>
                </span>
              </div>
            </form>
            <!-- /.search form -->

            <!-- Sidebar Menu -->
            <ul class="sidebar-menu">
              <li class="header">MENU</li>
              <!-- Optionally, you can add icons to the links -->
              <li class="active"><a href="#"><i class="fa fa-home"></i> <span>Home</span></a></li>
              <li><a href="tutorhistory.html"><i class="fa fa-history"></i> <span>Tutor History</span></a></li>
              <li><a href="payment.html"><i class="fa fa-money"></i> <span>Payment</span></a></li>
              <li><a href="help.html"><i class="fa fa-question"></i> <span>Help</span></a></li>
              <li><a href="setting.html"><i class="fa fa-gear"></i> <span>Settings</span></a></li>
              <li><a href="becometutor.html"><i class="fa fa-graduation-cap"></i> <span>Become a Tutor</span></a></li>
              <br>

              <li class="header" style="position:fixed; bottom:0px; width:230px; font-size: 9.5px; text-align: center;"> <!-- To the right -->
                <!-- Default to the left -->
                <strong>Copyright &copy; 2015 <a href="#">AsapTutor</a>.</strong> All rights reserved.
              </li>

            </ul><!-- /.sidebar-menu -->
          </section>
        </div>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div id="maincontentwrapper" class="content-wrapper")>
        <div id="googleMap" style="position:absolute; width:100%;height:134px;"></div>
        <!-- Content Header (Page header) -- NOT NEEDED -- 
        <section class="content-header">
          <h1>
            <small></small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>
            <li class="active">Here</li>
          </ol>
        </section>-->

        <!-- Main content -->
        <section class="content">
          <!-- Your Page Content Here -->
          <div id="paddingTop"></div>
          <div style="float:right;">
            <div class="btn-group-vertical">
              <button type="button" id='resetMap' class="btn btn-primary"><i class="fa fa-location-arrow"></i></button>
            </div>
          </div>
          <br><br>
          <div id="mainbox" class="box box-primary col-md-12"> <!--
                <div class="box-header with-border">
                  <h3 class="box-title">Header</h3>
                </div> -->
                <!-- form start -->
                <form role="form">
                  <div class="box-body">
                    <!-- text input -->
                    <div class="form-group">
                      <input id="topicQuestion" type="text" class="form-control" placeholder="[OPTIONAL] General Topic/Question   Eg:Calculus Matrix Multiplications">
                    </div>
                    <div style="float:left; width:60%;">
                      <div class="input-group">
                        <input type="text" id='eventPos' class="form-control" placeholder="Where to meet? Eg: Library">
                        <span style="cursor:pointer" id="cursorChange" class="input-group-addon"><i class="fa fa-map-pin"></i></span>
                      </div>
                    </div>
                    <div style="float:right; width:35%; text-align:center;">
                      <input id="durationSlider" type="text" data-slider-min="0" data-slider-tooltip="hide" data-slider-max="5" data-slider-step="1" data-slider-value="1"/>
                      <span class="text-black" style="font-weight: bold;">Meet <span id="duration">1</span> Hour(s)</span>
                    </div>
                  </div><!-- /.box-body -->
                  <div class="box-footer mainbox-footer">
                    <button type="submit" href="#control-sidebar-home-tab" data-toggle="tab" class="btn btn-primary" style="float: right; width:73%;" onclick="findTutors();">Find Tutors!</button>
                    <button type="submit" href="#" class="btn btn-danger" style="float: left; width:25%;" > <b><i>ASAP</i></b> <i class="fa fa-bolt"></i></button>
                  </div>
                </form>
              </div>

        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->
      <!-- Control Sidebar -->
      <aside id="rightsidebaraside" class="control-sidebar control-sidebar-dark">
        <!-- Create the tabs -->
        <ul id="rightsidetabs" class="nav nav-tabs nav-justified control-sidebar-tabs">
          <li id="searchTutorsRightBar" class="active"><a href="#control-sidebar-home-tab" data-toggle="tab" onclick="findTutors();"><i class="fa fa-search"></i></a></li>
          <li id="tutorProfileRightBar"><a href="#control-sidebar-settings-tab" data-toggle="tab" onclick="emptyTutorLogic();" ><i class="fa fa-user"></i></a></li>
          <li><a href="#" onclick="$.AdminLTE.controlSidebar.close();" style="cursor:pointer"><i class="fa fa-close"></i></a></li>
        </ul>
        <!-- Date and time range & time Picker-->
        <div class="bootstrap-timepicker">
          <div class="form-group">
            <div class="input-group">
              <div class="input-group-addon">
                <i class="fa fa-calendar"></i>
              </div>
              <input id="tutorDay" type="text" name="birthdate" value="" class="form-control pull-right" id="reservationtime"/>
            </div><!-- /.input group -->
            <div class="input-group">
              <div class="input-group-addon">
                <i class="fa fa-clock-o"></i>
              </div>
              <input id="tutorTime" type="text" class="form-control timepicker">
            </div><!-- /.input group -->
          </div><!-- /.form group -->
        </div>
        <h3 id="rightBarHeaderName" style="padding:0px 10px 0px 10px; text-align:center;" class="control-sidebar-heading">Tutors Near You</h3>
        <!-- Tab panes -->
        <div id="righttabcontent" class="tab-content" style="padding-left:10px; padding-right:10px;">
          <!-- Home tab content -->
          <div class="tab-pane" id="control-sidebar-home-tab">
            <ul id="tutorsList" class="control-sidebar-menu">
              <li>
                <a href="javascript::;">
                  <img src="dist/img/user1-128x128.jpg" class="user-image menu-icon" alt="User Image">
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Langdon Chen <span style="font-size:10px; color:grey;"> &nbsp;<b>0.3</b> mile(s)</span></h4>
                    <p><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> (13)</p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript::;">
                  <img src="dist/img/user3-128x128.jpg" class="user-image menu-icon" alt="User Image">
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Frodo Urlo <span style="font-size:10px; color:grey;"> &nbsp;<b>1.1</b> mile(s)</span></h4>
                    <p><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-o"> (8)</i></p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript::;">
                  <img src="dist/img/user4-128x128.jpg" class="user-image menu-icon" alt="User Image">
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Nora Park <span style="font-size:10px; color:grey;"> &nbsp;<b>1.9</b> mile(s)</span></h4>
                    <p><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-o"> (5)</i></p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript::;">
                  <img src="dist/img/user5-128x128.jpg" class="user-image menu-icon" alt="User Image">
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Cron Balmer <span style="font-size:10px; color:grey;"> &nbsp;<b>2.1</b> mile(s)</span></h4>
                    <p><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o">(2)</i>
                      </p>
                  </div>
                </a>
              </li>
            </ul><!-- /.control-sidebar-menu -->
          </div><!-- /.tab-pane -->
          <!-- Settings tab content -->
          <div class="tab-pane" id="control-sidebar-settings-tab">
                  <div class="hideTutorProfileWhenNoTutorSelected" style="text-align:center;">
                    <img id="tutorProfileImageHeader" src="dist/img/photo1.png" style="width:70%;" class="user-image img-circle" alt="User Image">
                    <p>
                      <h4 id="tutorProfileName" class="control-sidebar-subheading">Langdon Chen</h4>
                      <p style="margin-top: -8px;"><i id="tutorProfileStar1" class="fa fa-star"></i><i id="tutorProfileStar2" class="fa fa-star"></i><i id="tutorProfileStar3" class="fa fa-star"></i><i id="tutorProfileStar4" class="fa fa-star"></i><i id="tutorProfileStar5" class="fa fa-star"></i><span id="tutorProfileNumOfReviews"> (13)</span></p>
                      <p id="tutorProfileMembership" style="font-size:11px; margin-top:-10px;">Tutor since Nov. 2012</p>
                    </p>
                    <h4 class="control-sidebar-subheading">Biography</h4>
                    <p id="tutorBiography"  style="padding-left:10px; padding-right:10px; margin-top:-10px;"> 
                      I am aasdba nsbaisbasdng aosdgaso dfa asfihuasd fuah duiasfa sdfasdf.
                    </p>
                    <h4 class="control-sidebar-subheading">Flexiblity</h4>
                    <div style="text-align:center; padding-left:30px; padding-right:30px;">
                      <input id="flexibilitySlider" type="text" data-slider-min="0" data-slider-tooltip="hide" data-slider-max="120" data-slider-step="1" data-slider-value="0"/>
                      <p><span id="flexibility">0</span> Minutes(s)</p>
                    </div>
                    <div class="box-footer mainbox-footer">
                      <button id="confirmTutorButton" type="submit" href="#" class="btn btn-default" style="width:100%;" onclick="requestAppointment();">Confirm & Request!</button>
                    </div>
                  </div>
          </div><!-- /.tab-pane -->
        </div>
      </aside><!-- /.control-sidebar -->
      <!-- Add the sidebar's background. This div must be placed
           immediately after the control sidebar -->
      <div id="controlsidebarbg" class="control-sidebar-bg"></div>
    </div><!-- ./wrapper -->

    <!-- REQUIRED JS SCRIPTS -->

    <!-- jQuery 2.1.4 -->
    <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/app.js"></script>
    <!-- Bootstrap slider -->
    <script src="plugins/bootstrap-slider/bootstrap-slider.js"></script>
    <!-- Select2 -->
    <script src="plugins/select2/select2.full.min.js"></script>
    <!--Google Maps-->
    <script src="http://maps.googleapis.com/maps/api/js"></script>
     <!-- Firebase -->
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <!-- Dad's Map Implementation -->
    <script src="charliemap.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="dist/js/demoNoInject.js"></script>
    <!-- Optionally, you can add Slimscroll and FastClick plugins.
         Both of these plugins are recommended to enhance the
         user experience. Slimscroll is required when using the
         fixed layout. -->
    <!-- SlimScroll -->
    <script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="plugins/fastclick/fastclick.min.js"></script>
    <!-- date-range-picker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>
    <script src="plugins/daterangepicker/daterangepicker.js"></script>
    <!-- bootstrap time picker -->
    <script src="plugins/timepicker/bootstrap-timepicker.min.js"></script>
    <!--UI Main Js -->
    <script src="homePageUI.js"></script>
    <script>
    /******* FIREBASE CODE - MOVE TO JS FILE *******/
      var isTutorSelected = false;
      var loggedInUserLatLng = null;
      var selectedTutorID = null;
      var loggedInUserID = null;
      $( document ).ready(function() {

          $(".hideTutorProfileWhenNoTutorSelected").hide();

          // Register the callback to be fired every time auth state changes
          var ref = new Firebase("https://ubertutoralpha.firebaseio.com");
          ref.onAuth(authDataCallback);

          // Get a database reference to our posts
          var authData = ref.getAuth();

          if (authData) {
            console.log("Authenticated user with uid:", authData.uid);
            loggedInUserID = authData.uid;
            var ref = new Firebase("https://ubertutoralpha.firebaseio.com/users/"+authData.uid);

            // Attach an asynchronous callback to read the data at our posts reference
            ref.on("value", function(snapshot) {
              console.log(snapshot.val());
              updateUserImages(snapshot.val().imgUrl);
              updateUserName(snapshot.val().displayName)
              loggedInUserLatLng = snapshot.val().latlng;
            }, function (errorObject) {
              console.log("The read failed: " + errorObject.code);
            });
          }

          // Create a callback which logs the current auth state
          function authDataCallback(authData) {
            if (authData) {
              console.log("User " + authData.uid + " is logged in with " + authData.provider);
            } else {
              console.log("User is logged out");
            }
          }
      });
      function updateUserImages(imgURL){
        if (imgURL){
          $("#userImagePanel").attr("src", imgURL);
          $("#userImageNavbar").attr("src", imgURL);
          $("#userImageHeader").attr("src", imgURL);
        }
      }
      function updateUserName(userName){
        if(userName){
          $(".studentName").text(userName);
        }
      }
      function signOut(){
        var ref = new Firebase('https://ubertutoralpha.firebaseio.com');
        ref.unauth();
        window.location = '../FIREBASE.html';
      }
      function findTutors(){

        // Show Find Tutor as Header
        $("#rightBarHeaderName").text("Tutors Near You");
        $("#rightBarHeaderName").show();
        setSearchTutorsTabActive();

        //Forces Open Right Bar
        $.AdminLTE.controlSidebar.open();
        
        //get my location, duration, date, time, and match it with free schedule tutors
        var location = $("#eventPos").val();
        var duration = $("#duration").text();
        var hour = parseInt(moment($("#tutorDay").val()+" "+$("#tutorTime").val()).format("H"));
        var day = moment($("#tutorDay").val()+" "+$("#tutorTime").val()).format("dddd").toLowerCase();

        var ref = new Firebase("https://ubertutoralpha.firebaseio.com/users");

        // Attach an asynchronous callback to read the data at our posts reference
        ref.on("value", function(snapshot) {
          var userArr = snapshot.val();

          //Clear list before showing
          $("#tutorsList").empty();
          //Go through every user, and if they are tutor, and if is available, show on map/search
          $.each(userArr, function(uid, userObj){
            if(userObj.userType == "tutor"){

              var freeHoursArr = userObj.freeSchedule[day].freehours.split(",");
              var isTutorFree = true;
              for(var a = 0; a<duration; a++){
                if($.inArray(hour+a+"", freeHoursArr) == -1){ //-1 if doesn't exist, returns the index otherwise
                  isTutorFree = false;
                }
              }

              if(isTutorFree == true){
                  addTutorToDisplay(userObj, uid)
              }
            }
          })
        }, function (errorObject) {
          console.log("The read failed: " + errorObject.code);
        });
      }
      function addTutorToDisplay(userObj, uid){
        //User Image Loaction
        var userImg = userObj.imgUrl;
        //Distance
        var distance = Math.floor(Math.random()*10)+"."+Math.floor(Math.random()*10);
        if (loggedInUserLatLng && loggedInUserLatLng.split(",")[0]) {
            var lat1 = loggedInUserLatLng.split(",")[0];
            var lng1 = loggedInUserLatLng.split(",")[1];

            if (userObj && userObj.latlng && userObj.latlng.split(",")[0]) {
                var lat2 = userObj.latlng.split(",")[0];
                var lng2 = userObj.latlng.split(",")[1];
                distance = calcDistance(lat1,lng1,lat2,lng2,"M");
                distance = Math.ceil(distance * 100) / 100;
            }
        }

        //Display Name
        var displayName = userObj.displayName;
        //Stars -- TODO, get from reviews
        var stars = 3.5; 
        var numOfReview = 13;
        var starsHtml = "<i class='fa fa-star' onclick></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i>";

        $("#tutorsList").append("<li style='cursor:pointer;' onclick='setTutorProfileTabActive();'><a userObj='"+JSON.stringify(userObj)+"' onclick='updateTutorProfile(this)'><img src='"+userImg+"' class='user-image menu-icon' alt='User Image'><div class='menu-info'><h4 class='control-sidebar-subheading'>"+displayName+" <span style='font-size:10px; color:grey;'> &nbsp;<b>"+distance+"</b> mile(s)</span></h4><p>"+starsHtml+" ("+numOfReview+")</p></div></a></li>");
      }
      function setTutorProfileTabActive(){
        $('#rightsidetabs a[href="#control-sidebar-settings-tab"]').tab('show');
      }
      function setSearchTutorsTabActive(){
        $('#rightsidetabs a[href="#control-sidebar-home-tab"]').tab('show');
      }
      function emptyTutorLogic(){
        if(isTutorSelected == false){
          $('#rightBarHeaderName').text('No Tutor Selected');
        }else{
          $('#rightBarHeaderName').hide();
        }
      }
      function updateTutorProfile(_this){
        var usrObj=JSON.parse($(_this).attr("userObj"));
        console.log(usrObj);
        updateTutorProfileByObject(usrObj);

      }
      function updateTutorProfileByObject(usrObj){
        selectedTutorID = usrObj.uid;

        //Update Tutor Profile
        $("#tutorProfileImageHeader").attr("src", usrObj.imgUrl);
        $("#tutorProfileName").text(usrObj.displayName);
        $("#tutorProfileNumOfReviews").text(" (13)");
        $("#tutorProfileMembership").text("Tutor since Nov. 2012");
        $("#tutorBiography").text(usrObj.biography);
        $("#tutorProfileStar1").removeClass().addClass( "fa fa-star" );
        $("#tutorProfileStar2").removeClass().addClass( "fa fa-star" );
        $("#tutorProfileStar3").removeClass().addClass( "fa fa-star" );
        $("#tutorProfileStar4").removeClass().addClass( "fa fa-star-half-o" );
        $("#tutorProfileStar5").removeClass().addClass( "fa fa-star-o" );

        //Hide Find Tutor Header Name
        isTutorSelected = true;
        $("#rightBarHeaderName").hide();

        //Finished Updating Tutor Profile, Show it Now
        $(".hideTutorProfileWhenNoTutorSelected").show();

        //Hack - This supposes that everytime we update Tutor Profile, we want to display it as well.
        setTutorProfileTabActive();
      }

      function updateFreeSchedule(){
        var ref = new Firebase("https://ubertutoralpha.firebaseio.com");
        var authData = ref.getAuth();
        //Todo, build hours free for tutors scheduling system.
        ref.child("users").child(authData.uid).child("freeSchedule").set({
          monday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          tuesday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          wednesday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          thursday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          friday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          saturday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          },
          sunday: {
            freehours: "0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
          }
        });
      }
      // --TODO--
      function asap(){
        //Contact all tutors, even offline tutors 

      }
      // --TODO--
      function requestAppointment(){ 
        alert("trigger");
        //get Time, Day, latlng, duration, course, questionTopic
        var time = $("#tutorTime").val();
        var day = $("#tutorDay").val();
        var latlng = $("#eventPos").val().replace("(", "").replace(")","").replace(" ","");
        var duration = $("#duration").text();
        var courses = $("#select2ClassSelection").select2('val')+"";
        var questionTopic = $("#topicQuestion").val();
        
        //set status=AwaitingResponse, cost=null, declineMessage=null
        var ref = new Firebase("https://ubertutoralpha.firebaseio.com");

        //Saves Appointment and Creates Appointment UID
        var appointment = ref.child("appointments").push({
          studentID: loggedInUserID,
          tutorID: selectedTutorID,
          time: time,
          day: day,
          latlng: latlng,
          duration: duration,
          cost: "null",
          status: "Awaiting Response",
          courses: courses,
          declineMessage: "null",
          questionTopic:  questionTopic,
          creationDate: moment().format("M/D/YYYY h:m:s a")
        });
        var appointmentID = appointment.key();

        //Saves AppointmentUID for Student
        ref.child("users").child(loggedInUserID).child("appointmentIDs").child(appointmentID).set({
          tutorID: selectedTutorID
        });

        //Saves AppointmentUID for Tutor
        ref.child("users").child(selectedTutorID).child("appointmentIDs").child(appointmentID).set({
          studentID: loggedInUserID
        });
      }
      //:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      //:::                                                                         :::
      //:::  This routine calculates the distance between two points (given the     :::
      //:::  latitude/longitude of those points). It is being used to calculate     :::
      //:::  the distance between two locations using GeoDataSource (TM) prodducts  :::
      //:::                                                                         :::
      //:::  Definitions:                                                           :::
      //:::    South latitudes are negative, east longitudes are positive           :::
      //:::                                                                         :::
      //:::  Passed to function:                                                    :::
      //:::    lat1, lon1 = Latitude and Longitude of point 1 (in decimal degrees)  :::
      //:::    lat2, lon2 = Latitude and Longitude of point 2 (in decimal degrees)  :::
      //:::    unit = the unit you desire for results                               :::
      //:::           where: 'M' is statute miles (default)                         :::
      //:::                  'K' is kilometers                                      :::
      //:::                  'N' is nautical miles                                  :::
      //:::                                                                         :::
      //:::  Worldwide cities and other features databases with latitude longitude  :::
      //:::  are available at http://www.geodatasource.com                          :::
      //:::                                                                         :::
      //:::  For enquiries, please contact sales@geodatasource.com                  :::
      //:::                                                                         :::
      //:::  Official Web site: http://www.geodatasource.com                        :::
      //:::                                                                         :::
      //:::               GeoDataSource.com (C) All Rights Reserved 2015            :::
      //:::                                                                         :::
      //:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

      function calcDistance(lat1, lon1, lat2, lon2, unit) {
        var radlat1 = Math.PI * lat1/180;
        var radlat2 = Math.PI * lat2/180;
        var radlon1 = Math.PI * lon1/180;
        var radlon2 = Math.PI * lon2/180;
        var theta = lon1-lon2;
        var radtheta = Math.PI * theta/180;
        var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
        dist = Math.acos(dist);
        dist = dist * 180/Math.PI;
        dist = dist * 60 * 1.1515;
        if (unit=="K") { dist = dist * 1.609344; }
        if (unit=="N") { dist = dist * 0.8684; }
        return dist;
      }
    </script>


  </body>
</html>
